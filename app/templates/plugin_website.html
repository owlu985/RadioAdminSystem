<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Website Content Plugin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
{% include '_nav.html' %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h3 class="mb-0">Website Content Plugin</h3>
      <small class="text-muted">Control headline, hero image, and podcast embeds for the public site.</small>
    </div>
    <div class="text-end">
      <div class="mb-2">
        {% if plugin.enabled %}
          <span class="badge bg-success">Enabled</span>
        {% else %}
          <span class="badge bg-secondary">Disabled</span>
        {% endif %}
      </div>
      <form method="post" action="{{ url_for('main.toggle_plugin', name='website_content') }}" class="d-inline">
        <button class="btn btn-sm btn-outline-primary" type="submit">{{ 'Disable' if plugin.enabled else 'Enable' }}</button>
      </form>
      <a class="btn btn-sm btn-secondary" href="{{ url_for('main.plugins_home') }}">Back</a>
    </div>
  </div>

  <div class="card mb-4">
    <div class="card-header">Front Page Content</div>
    <div class="card-body">
      <form method="post">
        <input type="hidden" name="action" value="save_content">
        <div class="mb-3">
          <label class="form-label">Headline</label>
          <input type="text" name="headline" class="form-control" value="{{ content.headline or '' }}" placeholder="Front page headline">
        </div>
        <div class="mb-3">
          <label class="form-label">Body</label>
          <textarea name="body" rows="4" class="form-control" placeholder="Front page body copy">{{ content.body or '' }}</textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Image URL</label>
          <input type="text" name="image_url" class="form-control" value="{{ content.image_url or '' }}" placeholder="https://...">
          <small class="text-muted">Provide a full URL to the hero image used on the website.</small>
        </div>
        <button class="btn btn-primary" type="submit">Save Content</button>
      </form>
    </div>
  </div>

  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <span>Podcasts</span>
      <span class="text-muted">Embed codes from iHeart or other platforms.</span>
    </div>
    <div class="card-body">
      <form method="post" class="row g-3 mb-4">
        <input type="hidden" name="action" value="add_podcast">
        <div class="col-md-4">
          <label class="form-label">Title</label>
          <input type="text" name="podcast_title" class="form-control" placeholder="Podcast title" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Description (optional)</label>
          <input type="text" name="podcast_description" class="form-control" placeholder="Short description">
        </div>
        <div class="col-md-4">
          <label class="form-label">Embed Code</label>
          <textarea name="podcast_embed" class="form-control" rows="2" placeholder="Paste embed HTML" required></textarea>
        </div>
        <div class="col-12 text-end">
          <button class="btn btn-success" type="submit">Add Podcast</button>
        </div>
      </form>

      {% if podcasts %}
        <div class="table-responsive">
          <table class="table align-middle">
            <thead>
              <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Embed Preview</th>
                <th class="text-end">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for pod in podcasts %}
                <tr>
                  <td class="fw-semibold">{{ pod.title }}</td>
                  <td>{{ pod.description or '' }}</td>
                  <td><code class="small">{{ pod.embed_code[:80] }}{% if pod.embed_code|length > 80 %}...{% endif %}</code></td>
                  <td class="text-end">
                    <form method="post" class="d-inline">
                      <input type="hidden" name="action" value="delete_podcast">
                      <input type="hidden" name="podcast_id" value="{{ pod.id }}">
                      <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p class="text-muted mb-0">No podcasts added yet.</p>
      {% endif %}
    </div>
  </div>
</div>
{% include '_footer.html' %}
</body>
</html>
