<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <title>AutoDJ Control</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
{% include '_nav.html' %}
<div class="container mt-4">
    <div class="card">
        <div class="card-header">AutoDJ Control</div>
        <div class="card-body">
            <p class="text-muted mb-3">Use this menu to toggle RadioDJ AutoDJ on/off before going live.</p>
            <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-success" id="autodjOn">Enable AutoDJ</button>
                <button class="btn btn-danger" id="autodjOff">Disable AutoDJ</button>
            </div>
            <div class="mt-3" id="autodjStatus"></div>
            <div class="text-muted small mt-2">If dead air lasts 4+ minutes, RAMS will automatically re-enable AutoDJ.</div>
        </div>
    </div>
</div>
{% include '_footer.html' %}
<script>
    const statusEl = document.getElementById('autodjStatus');
    async function toggleAutoDJ(enabled) {
        statusEl.textContent = 'Sending...';
        const res = await fetch('/api/radiodj/autodj', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({enabled})
        });
        const data = await res.json();
        if (data.status === 'ok') {
            statusEl.className = 'text-success';
            statusEl.textContent = enabled ? 'AutoDJ enabled.' : 'AutoDJ disabled.';
        } else {
            statusEl.className = 'text-danger';
            statusEl.textContent = data.message || 'Unable to update AutoDJ.';
        }
    }
    document.getElementById('autodjOn').addEventListener('click', () => toggleAutoDJ(true));
    document.getElementById('autodjOff').addEventListener('click', () => toggleAutoDJ(false));
</script>
</body>
</html>
